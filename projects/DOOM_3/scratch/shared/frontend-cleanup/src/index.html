<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cleanup Tasks - React Frontend</title>
    <style>
      :root{--bg:#0b1020;--card:#141a33;--text:#e8eaf6;--muted:#a6b0d6;--accent:#6ea8fe;--success:#1faa63;--warning:#f5a524;}
      *{box-sizing:border-box}
      html,body,#root{height:100%}
      body{margin:0;background:var(--bg);font-family:Inter, ui-sans-serif, system-ui; color:var(--text);} 
      a{color:inherit}
      .container{max-width:1100px;margin:0 auto;padding:20px}
      .header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin:12px 0 20px}
      .brand{display:flex;align-items:center;gap:12px}
      .brand-logo{width:28px;height:28px;border-radius:8px;background:var(--accent)}
      .title{font-weight:700;font-size:22px}
      .badge{background:var(--accent);color:white;padding:6px 10px;border-radius:999px;font-size:12px}
      .grid{display:grid;grid-template-columns:1.1fr 0.9fr;gap:20px}
      @media (max-width: 900px){.grid{grid-template-columns:1fr}}
      .card{background:var(--card);border-radius:14px;padding:18px;box-shadow:0 8px 20px rgba(0,0,0,.25)}
      .card h3{margin:0 0 12px 0;font-size:18px}
      .form{display:flex;flex-direction:column;gap:12px}
      .form label{font-size:12px;color:var(--muted)}
      .form input,.form select,.form textarea{padding:10px;border-radius:8px;border:1px solid #2b2f55;background:#0d1230;color:white}
      .row{display:flex;gap:10px}
      .btn{padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:white;font-weight:600;cursor:pointer}
      .btn.secondary{background:#2a315a}
      .btn.ghost{background:transparent;border:1px solid #2b2f55;color:white}
      .list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px}
      .item{display:flex;justify-content:space-between;align-items:center;background:#0e1630;padding:12px;border-radius:8px}
      .item .left{display:flex;gap:10px;align-items:center}
      .item-title{font-weight:600}
      .status{padding:4px 8px;border-radius:999px;font-size:12px; text-transform:uppercase}
      .status.pending{background:#f7b500;color:#111}
      .status.ongoing{background:#2f7bd8;color:white}
      .status.done{background:#1faa63;color:white}
      .dashboard{display:flex;flex-direction:column;gap:12px}
      .stat{display:flex;gap:12px;flex-wrap:wrap}
      .box{flex:1 1 180px;background:#0e1740;border-radius:12px;padding:12px}
      .box h4{margin:0;font-size:12px;color:#bbb}
      .box .val{font-size:22px;font-weight:700;color:white}
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
      // Minimal React frontend to interact with a cleanup backend
      const API_BASE = '/api/tasks'; // Adjust to your backend base URL if needed

      function StatusBadge({status}){
        const cls = 'status ' + (status || 'pending');
        return <span className={cls} aria-label={`Status: ${status}`}>{status}</span>;
      }

      function TaskRow({task, onStatusChange}){
        const [localStatus, setLocalStatus] = React.useState(task.status);
        React.useEffect(()=>{ setLocalStatus(task.status); }, [task.id, task.status]);
        const updateStatus = async (e)=>{
          const newStatus = e.target.value;
          setLocalStatus(newStatus);
          if(onStatusChange){ await onStatusChange(task.id, newStatus); }
        };
        return (
          <li className="item" aria-label={`Task ${task.title}`}>
            <div className="left">
              <span aria-hidden="true" style={{width:8, height:8, borderRadius:4, background:'#6ea8fe', display:'inline-block'}}></span>
              <span className="item-title">{task.title}</span>
            </div>
            <div style={{display:'flex', gap:8, alignItems:'center'}}>
              <select aria-label="Change status" value={localStatus} onChange={updateStatus}>
                <option value="pending">Pending</option>
                <option value="ongoing">Ongoing</option>
                <option value="done">Done</option>
              </select>
              <StatusBadge status={task.status} />
            </div>
          </li>
        );
      }

      function App(){
        const [tasks, setTasks] = React.useState([]);
        const [loading, setLoading] = React.useState(false);
        const [title, setTitle] = React.useState('');
        const [status, setStatus] = React.useState('pending');

        const fetchTasks = async ()=>{
          setLoading(true);
          try{
            const res = await fetch(API_BASE);
            if(res.ok){ const data = await res.json(); setTasks(data); }
            else { console.error('Failed to fetch tasks', res.status); }
          } catch(err){ console.error(err); }
          setLoading(false);
        };

        const createTask = async ()=>{
          if(!title.trim()) return;
          try{
            const res = await fetch(API_BASE, {
              method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({title: title.trim(), status})
            });
            if(res.ok){ setTitle(''); setStatus('pending'); fetchTasks(); }
            else{ console.error('Create failed', res.status); }
          } catch(err){ console.error(err); }
        };

        const updateTaskStatus = async (id, newStatus)=>{
          try{
            const res = await fetch(`${API_BASE}/${id}`, {
              method:'PATCH', headers:{'Content-Type':'application/json'}, body: JSON.stringify({status: newStatus})
            });
            if(res.ok){ // optimistic refresh
              setTasks(ts => ts.map(t => t.id===id ? {...t, status: newStatus} : t));
            } else {
              console.error('Update failed', res.status);
            }
          } catch(err){ console.error(err); }
        };

        React.useEffect(()=>{ fetchTasks(); }, []);

        const total = tasks.length;
        const pending = tasks.filter(t=>t.status==='pending').length;
        const ongoing = tasks.filter(t=>t.status==='ongoing').length;
        const done = tasks.filter(t=>t.status==='done').length;

        return (
          <div className="container" aria-label="Cleanup Tasks App">
            <div className="header">
              <div className="brand">
                <div className="brand-logo" aria-hidden="true"></div>
                <div className="title">Cleanup Tasks</div>
              </div>
              <span className="badge" aria-label="Demo badge">React UI</span>
            </div>
            <div className="grid">
              <section className="card" aria-label="Task List">
                <h3>Tasks</h3>
                <div className="row" style={{marginBottom:12}}>
                  <input aria-label="Task title" placeholder="New task title" value={title} onChange={e=>setTitle(e.target.value)} style={{flex:1, padding:10, borderRadius:8, border:'1px solid #2b2f55', background:'#0d1230', color:'#fff'}} />
                  <select aria-label="Initial status" value={status} onChange={e=>setStatus(e.target.value)} style={{padding:10, borderRadius:8, border:'1px solid #2b2f55', background:'#0d1230', color:'#fff'}}>
                    <option value="pending">Pending</option>
                    <option value="ongoing">Ongoing</option>
                    <option value="done">Done</option>
                  </select>
                  <button className="btn" onClick={createTask} aria-label="Add task">Add</button>
                </div>
                {loading ? <div>Loading...</div> : null}
                <ul className="list" aria-label="Task list">
                  {tasks.map(t => (
                    <TaskRow key={t.id} task={t} onStatusChange={updateTaskStatus} />
                  ))}
                </ul>
              </section>
              <section className="card" aria-label="Dashboard">
                <h3>Dashboard</h3>
                <div className="stat" aria-label="Stats">
                  <div className="box"><h4>Total</h4><div className="val" aria-label="Total tasks">{total}</div></div>
                  <div className="box"><h4>Pending</h4><div className="val" aria-label="Pending tasks">{pending}</div></div>
                  <div className="box"><h4>Ongoing</h4><div className="val" aria-label="Ongoing tasks">{ongoing}</div></div>
                  <div className="box"><h4>Done</h4><div className="val" aria-label="Done tasks">{done}</div></div>
                </div>
              </section>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
  </body>
</html>
